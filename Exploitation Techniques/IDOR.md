# IDOR (Insecure Direct Object Reference)

## Learning objectives
- Understand what an IDOR is
- Recognize common patterns
- Learn how to test for IDORs
- Apply a practical scenario

## What is an IDOR
- An access control vulnerability
- The server trusts user-supplied object references too much
- No server-side check that the object belongs to the current user

## Simple example
- Invoice URL: `https://onlinestore.thm/order/1234/invoice`
- If `1234` is your order ID, changing it may expose other invoices

## Finding IDORs
### Encoded IDs
- Base64 is common and reversible
- Decode, modify, re-encode, and replay the request

### Hashed IDs
- May be hashes of incremental IDs
- Try hash lookup services (e.g., crackstation) for common hashes

### Unpredictable IDs
- Create two accounts and swap IDs
- If you can access another user's data, it is an IDOR

## Where they show up
- URL paths (`/invoice/1234`)
- Query parameters (`?user_id=123`)
- Hidden fields or cookies
- AJAX endpoints or JS-referenced APIs

## Mitigation
- Enforce object-level authorization on the server
- Use indirect references or random IDs where possible
- Log and alert on unauthorized access attempts
- Apply least privilege and strong session handling
